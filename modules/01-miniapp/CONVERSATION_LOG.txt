模块：01-miniapp
窗口负责人：
开始时间：

【记录规则】
1) 只记录与本模块有关的对话与决定（不要粘贴敏感信息：账号/密码/密钥）。
2) 每次对话后追加一段，格式如下。

--- 2026-01-20 12:00 ---
用户：
助手：
决定/结论：
下一步：

--- 2026-01-21 01:12 ---
用户：按本模块 `AUTOPILOT.md` 从 M1 开始连续做到完成；每完成一个里程碑 commit+push，并在本模块日志写验收路径。
助手：切到 `feat/01-miniapp-autopilot-winE3`（基于 `origin/main`）并按 M1 完成底部导航 + 三大主页面骨架：新增“课程”Tab 与课程页（Mock 列表），并提供播放页占位（用于后续 M3 续播）。
验收路径：微信开发者工具导入 `modules/01-miniapp/miniprogram` → `pages/start/index` 点击“立即进入” → 底部 Tab 依次进入：`pages/index/index`、`pages/library/index`、`pages/course/index`、`pages/my/index`；课程页点任意卡片进入 `pages/course/player`。
证据：`modules/01-miniapp/_evidence/M1/README.md`（记录人工验收路径；MCP 自动化未接入）。

--- 2026-01-21 01:18 ---
用户：按 `AUTOPILOT.md` 继续。
助手：完成 M2 题库页信息结构（Mock）：在 `pages/library/index` 支持切换 `初中/单招`，并按年级/册别/科目（初中）或科目/题型（单招）生成单元列表；点击单元进入占位页 `pages/library/unit/index`，展示路径并提供“同步试题(预览)/在线做题(练习/测评)”按钮（提示后置）。
验收路径：底部 Tab → 题库 `pages/library/index` → 切换 `初中/单招` 与筛选项 → 点击任意单元卡片进入 `pages/library/unit/index`。
证据：`modules/01-miniapp/_evidence/M2/README.md`。

--- 2026-01-21 01:32 ---
用户：按 `AUTOPILOT.md` 继续。
助手：完成 M3 课程播放页续播记录（Mock）：播放页以 `wx.setStorageSync('course_progress_<id>')` 记录当前进度（通过“模拟播放 +10s”和滑块模拟），再次进入同一课程时弹窗提示并可选择“继续/重新开始”。
验收路径：底部 Tab → 课程 `pages/course/index` → 点击任意课程进入 `pages/course/player?id=<id>` → 调整进度（按钮/滑块）→ 返回课程列表 → 再次进入同一课程，验证续播弹窗与恢复/重置。
证据：`modules/01-miniapp/_evidence/M3/README.md`。

--- 2026-01-21 01:45 ---
用户：按 `AUTOPILOT.md` 继续。
助手：完成 M4 SVIP 绑定（UI + 本地验证占位）：新增 `pages/svip/bind/index`，支持输入码校验（Mock 正确码 `JLXB-SVIP-OK`）并写入本地状态；我的页新增“SVIP 权益”卡片与“SVIP码绑定”入口；课程播放页增加“未开通提示（paywall 文案）”占位并提供跳转入口。
验收路径：我的 `pages/my/index` → 点击“SVIP 权益/去绑定”或“SVIP码绑定” → `pages/svip/bind/index` → 输入错误码提示无效 → 输入 `JLXB-SVIP-OK` 提示绑定成功并显示状态；未绑定时进入 `pages/course/player?id=<id>` 可看到“SVIP 未开通（占位）”文案与入口。
证据：`modules/01-miniapp/_evidence/M4/README.md`。

--- 2026-01-21 01:58 ---
用户：按 `AUTOPILOT.md` 继续。
助手：完成 M5 视觉统一小改（以可演示为主）：全局统一浅灰背景；抽出通用 banner 样式，并在题库/课程页补齐顶部 banner，提高信息密度与展示效果。
验收路径：`pages/start/index` → 立即进入 → 首页 `pages/index/index` → 题库 `pages/library/index`（banner+筛选+卡片）→ 课程 `pages/course/index`（banner+卡片）→ 我的 `pages/my/index`（SVIP 权益卡片）。
证据：`modules/01-miniapp/_evidence/M5/README.md`。

--- 2026-01-21 02:24 ---
用户：继续。
助手：按 `TASKS.md` 推进 MVP：考试模式在 Mock 下完整走通（随机抽题 + 倒计时 + 交卷到结果页），并扩充 mock 题目以满足题量抽取；同时在 `USE_MOCK` 下放宽考试入口的登录限制，方便演示。
验收路径：`pages/start/index` → 立即进入 → 首页点“答题”进入 `pages/exam-menu/index` → 选择任意题库进入 `pages/exam/index` → 作答若干题 → 点击右上角“交卷”确认 → 跳转 `pages/examResult/index` 展示得分/用时/错题入口。
下一步：如需合并请求记录，请由 99-hub 窗口将分支 `feat/01-miniapp-mvp-exam-winE3` 的 MR 需求写入 `modules/99-hub/REQUESTS.md`（本窗口只改本模块目录）。

--- 2026-01-21 03:32 ---
用户：继续。
助手：按 `TASKS.md` 推进 MVP：我的页授权登录保持本地（Mock）存储并展示基础信息；补充“退出登录（清空本地 userInfo）”入口；启动页在 `USE_MOCK` 下不再强行调用 `wx.getUserInfo`，直接读取本地缓存并提供默认头像，避免未授权时报错。
验收路径：`pages/start/index` → 立即进入 → 底部“我的” `pages/my/index` → 点击“点击登录”弹出授权层 → “立即登录”完成后显示头像/昵称（及 department 如有）→ 点击列表“退出登录”确认清空本地 userInfo，页面恢复未登录态。
下一步：如需合并请求记录，请由 99-hub 窗口将分支 `feat/01-miniapp-mvp-my-login-winE3` 的 MR 需求写入 `modules/99-hub/REQUESTS.md`（本窗口只改本模块目录）。

--- 2026-01-21 03:38 ---
用户：每次 push 新 feat 分支后，都要再 push 一个只改 `modules/99-hub/REQUESTS.md` 的 `feat/99-hub-request-xxx`（或让 99-hub 代写），至少包含：`- [ ] \\feat/xxx` + 验收方式。
助手：已知悉该流程要求；本窗口遵守“只改本模块目录”约束，无法直接修改 `modules/99-hub/REQUESTS.md`，将统一由 99-hub 窗口代写对应的 request 分支。
下一步：请 99-hub 为以下分支分别补一行 request（含验收方式）：`feat/01-miniapp-m7-news-tab-winE3`、`feat/01-miniapp-mvp-wrong-winE3`、`feat/01-miniapp-mvp-star-winE3`、`feat/01-miniapp-mvp-my-login-winE3`。

--- 2026-01-21 03:55 ---
用户：继续。
助手：按 `TASKS.md`（2.1 题库页）补齐顶部轮播（Mock 可配置）：题库页新增 swiper（自动/手动切换 + 指示器），并支持点击 banner 进行 `switchTab/navigateTo/toast` 跳转占位。
验收路径：`pages/start/index` → 立即进入 → 底部题库 `pages/library/index` → 顶部轮播可左右滑动/自动切换，点击三张 banner 分别：提示 toast / 进入 `pages/exam-menu/index` / 切换到 `pages/news/index`。
下一步：请 99-hub 在 `modules/99-hub/REQUESTS.md` 入队：`feat/01-miniapp-library-swiper-winE3`（验收按上述路径）。

--- 2026-01-21 ---
分支：feat/01-miniapp-library-swiper-winE3
验收：
- `pages/start/index` → 立即进入 → 底部题库 `pages/library/index`
- 顶部轮播可左右滑动/自动切换；点击三张 banner 分别：toast / `pages/exam-menu/index` / 切换到 `pages/news/index`
变更点：
- 题库页新增顶部 swiper 轮播（Mock 数据、指示器、自动/手动切换）
- banner 点击支持 `switchTab/navigateTo/toast` 跳转占位

--- 2026-01-21 ---
分支：feat/01-miniapp-library-subject-gating-winE3
验收：
- `pages/start/index` → 立即进入 → 底部题库 `pages/library/index`
- 初中学段：切换年级“初一/初二/初三”，观察科目 chips 动态隐藏（初一无物理/化学；初二无化学；初三全量）
变更点：
- 题库页按年级动态生成科目列表（教学进度 gating）
- 切年级时自动纠正当前科目，避免选中不可见科目导致前缀异常

--- 2026-01-21 ---
分支：feat/01-miniapp-library-config-winE3
验收：
- `pages/start/index` → 立即进入 → 底部题库 `pages/library/index`
- 顶部轮播数据来自 `miniprogram/mock/library-config.json`，点击各 banner 跳转/提示同之前一致
变更点：
- 题库页轮播配置改为本地 JSON 驱动（便于后续接后端配置）
- 保留原跳转处理逻辑不变

--- 2026-01-21 ---
分支：feat/01-miniapp-library-online-winE3
验收：
- `pages/start/index` → 立即进入 → 底部题库 `pages/library/index` → 任意单元进入 `pages/library/unit/index`
- 点击“在线做题(练习/测评)”选择“练习”进入 `pages/learn/index?cateid=menu_demo_1`；选择“测评”进入 `pages/exam/index?cateid=menu_demo_1` 并可交卷到 `pages/examResult/index`
变更点：
- 单元页“在线做题(练习/测评)”从占位改为可跳转现有练习/考试页（Mock）
- 修复考试随机抽题在题量大于题库实际题数时的边界问题

--- 2026-01-21 ---
分支：feat/01-miniapp-library-config-require-fix-winE3-v2
验收：
- 微信开发者工具（基础库 3.12.1）启动无报错
- 可进入 `pages/library/index`（题库 tab）与 `pages/course/index`（课程 tab）且页面正常注册
变更点：
- 将 `miniprogram/mock/library-config.json` 改为 `miniprogram/mock/library-config.js`（`module.exports`），避免 require JSON 在 3.12.1 下报 “module ... is not defined”
- 移除/替换指向不存在页面的 banner 跳转（原 `/pages/news/index` 改为 toast 占位）

--- 2026-01-21 ---
分支：feat/01-miniapp-fs-manager-savefile-winE3-v1
验收：
- 题库/考试页加载 Mock 题目无异常
变更点：
- Mock 题目选项中将 `wx.saveFile` 文案更新为 `wx.getFileSystemManager().saveFile`，对齐基础库废弃提示

--- 2026-01-21 ---
分支：feat/01-miniapp-home-ui-commercial-winE3-v1
验收：
- `pages/start/index` → 立即进入 → `pages/index/index`（首页）
- 首页可见：顶部 banner 轮播、学段切换（初中/单招）、转化卡（未绑定显示“绑定SVIP/付费开通”，已绑定显示状态）、推荐课程/题库列表；点击 banner/推荐项可跳转到题库/课程/考试菜单/SVIP 绑定
变更点：
- 首页 UI 补齐“商业位骨架”（banner/学段/转化/推荐），配置改为本地 `miniprogram/mock/home-config.js` 驱动（避免 JSON require 兼容问题）
- 修正首页“答题”入口从 `switchTab` 改为 `navigateTo /pages/exam-menu/index`

--- 2026-01-21 ---
分支：feat/01-miniapp-home-ui-commercial-winE3-v2
验收：
- 微信开发者工具启动无 `home-config` require 报错
- `pages/start/index` → 立即进入 → `pages/index/index`（首页）正常渲染 banner/学段/转化/推荐，点击跳转正常
变更点：
- 将首页配置从 `miniprogram/mock/home-config.js` 移到 `miniprogram/pages/index/home-config.js`，避免某些基础库下 mock 目录模块未注册导致 require 失败

--- 2026-01-21 ---
分支：feat/01-miniapp-home-ui-card-style-fix-winE3-v3
验收：
- `pages/start/index` → 立即进入 → `pages/index/index`（首页）
- 首页“推荐课程”横向滑动卡片文字不再被裁切/遮挡（标题/副标题/标签/价格完整可见）
变更点：
- 修复横向滚动区在部分基础库下高度计算导致内容裁切：为 `scroll-view.h-list` 与 `.h-item` 设置高度，并用 flex 布局把 meta 行固定到底部

--- 2026-01-21 ---
分支：feat/01-miniapp-home-banner-title-safe-winE3-v4
验收：
- `pages/index/index` 首页 banner 文案不被指示器圆点遮挡（底部留白足够）
变更点：
- 调整 banner 标题与 swiper dots 的底部间距（提升标题位置 + 增加渐变遮罩高度）
--- 2026-01-21 ---
分支：feat/01-miniapp-course-paywall-gating-winE3
验收：
- `pages/start/index` → 立即进入 → 底部课程 `pages/course/index`
- 未绑定 SVIP 时点击任意课程卡片弹出“SVIP 未开通”提示，点“去绑定”进入 `pages/svip/bind/index`；绑定成功后返回课程页再次点击可进入 `pages/course/player`
变更点：
- 课程页增加 SVIP 权限拦截占位（未绑定时引导去绑定）
- 不改变课程卡片展示内容，仅控制进入播放页的入口

